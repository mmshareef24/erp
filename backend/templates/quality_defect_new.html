<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Quality â€¢ {% if item %}Edit Defect{% else %}Log Defect{% endif %}</title>
    <link rel="stylesheet" href="/static/styles.css" />
  </head>
  <body>
    <header class="topbar">
      <div class="brand">Matrix ERP</div>
      <nav class="breadcrumbs"><a href="/">Apps</a> / <a href="/app/quality">Quality</a> / <a href="/quality/defects">Defects</a> / {% if item %}Edit{% else %}New{% endif %}</nav>
    </header>

    <main class="content">
      <div class="card">
        <h2>{% if item %}Edit Non-Compliance / Defect{% else %}Log Non-Compliance / Defect{% endif %}</h2>
        <form method="post" action="{% if item %}/quality/defects/{{ item.id }}{% else %}/quality/defects{% endif %}" class="form">
          <div class="form-row">
            <label>Reference</label>
            <input type="text" name="reference" placeholder="Batch/W.O./Product" value="{{ item.reference if item }}" />
          </div>
          <div class="form-row">
            <label>Stage</label>
            <select name="stage">
              <option value="raw" {% if item and item.stage=='raw' %}selected{% endif %}>Raw</option>
              <option value="in_process" {% if item and item.stage=='in_process' %}selected{% endif %}>In-Process</option>
              <option value="final" {% if item and item.stage=='final' %}selected{% endif %}>Final</option>
            </select>
          </div>
          <div class="form-row">
            <label>Category</label>
            <input type="text" name="category" placeholder="e.g., Dimensional, Surface, Packaging" value="{{ item.category if item }}" />
          </div>
          <div class="form-row">
            <label>Severity</label>
            <select name="severity">
              <option value="minor" {% if item and item.severity=='minor' %}selected{% endif %}>Minor</option>
              <option value="major" {% if item and item.severity=='major' %}selected{% endif %}>Major</option>
              <option value="critical" {% if item and item.severity=='critical' %}selected{% endif %}>Critical</option>
            </select>
          </div>
          <div class="form-row">
            <label>NC Code</label>
            <input type="text" name="nc_code" placeholder="Internal/ISO code" value="{{ item.nc_code if item }}" />
          </div>
          <div class="form-row">
            <label>Description</label>
            <textarea name="description" rows="4">{{ item.description if item }}</textarea>
          </div>
          <div class="form-row">
            <label>Actions Taken</label>
            <textarea name="actions" rows="3">{{ item.actions if item }}</textarea>
          </div>
          <div class="form-row">
            <label>Status</label>
            <select name="status">
              <option value="open" {% if item and item.status=='open' %}selected{% endif %}>Open</option>
              <option value="closed" {% if item and item.status=='closed' %}selected{% endif %}>Closed</option>
            </select>
          </div>
          <div class="actions">
            <button class="btn btn-primary" type="submit">Save</button>
            <a class="btn" href="/quality/defects">Cancel</a>
          </div>
        </form>
      </div>
    </main>
  </body>
</html>